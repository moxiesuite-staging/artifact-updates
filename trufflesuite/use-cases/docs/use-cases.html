

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Use Cases &mdash; Proposal: New Truffle Artifacts Format  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Glossary" href="glossary.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Proposal: New Truffle Artifacts Format
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#saving-artifacts">Saving artifacts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#save-contract-type">Save contract type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#save-contract-instance">Save contract instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#save-library-instance">Save library instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#save-interface-instance">Save interface instance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compilation">Compilation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compile-all-project-sources">Compile all project sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compile-modified-project-sources">Compile modified project sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#determine-modified-sources">Determine modified sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compile-source-file">Compile source file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compile-primary-and-related-source-files">Compile primary and related source files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-contract-metadata">Reading contract metadata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#read-contract-instance-information">Read contract instance information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-contract-type-info">Read contract type info</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-contract-instance-historical-type-info">Read contract instance historical type info</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#querying-for-specific-contracts">Querying for specific contracts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#query-for-instance-by-network-and-address">Query for instance by network and address</a></li>
<li class="toctree-l3"><a class="reference internal" href="#query-all-contracts-with-a-given-bytecode">Query all contracts with a given bytecode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#query-for-bytecode-ignoring-link-references">Query for bytecode ignoring link references</a></li>
<li class="toctree-l3"><a class="reference internal" href="#query-known-instances-on-a-given-network">Query known instances on a given network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#query-all-networks-for-a-given-type">Query all networks for a given type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#query-all-networks-for-instances-with-a-given-role">Query all networks for instances with a given role</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interacting-with-deployed-instances">Interacting with deployed instances</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#call-read-only-method">Call read-only method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#invoke-method-via-a-transaction">Invoke method via a transaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#send-eth-to-a-contract-instance">Send ETH to a contract instance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#linking">Linking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#link-contract-type-to-library-instance">Link contract type to library instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#link-contract-instance-to-library-instance">Link contract instance to library instance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deployment">Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#deploy-instance-of-a-type">Deploy instance of a type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploy-multiple-instances">Deploy multiple instances</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#migrations">Migrations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#determine-last-completed-migration">Determine last completed migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-all-migrations">Run all migrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-specific-migration">Run specific migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-with-historical-types">Run with historical types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-automated-tests-for-contract-type">Run automated tests for contract type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-automated-tests-for-contract-instance">Run automated tests for contract instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-automated-tests-for-library-type">Run automated tests for library type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-automated-tests-for-library-instance">Run automated tests for library instance</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Proposal: New Truffle Artifacts Format</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Use Cases</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/docs/use-cases.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="use-cases">
<h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h1>
<p>The following use cases represent the kinds of interaction users may have with
Truffle and other tools. These use cases serve to help validate proposals for
changes to Truffle’s artifact format.</p>
<p>These use cases are written primarily for Truffle, as the primary producer
and consumer of artifacts, but should apply generally for any and all
tooling for smart contract / decentralized application development.</p>
<p>Since the process to develop and deploy a decentralized applications can
include many participants, these use cases refer to several different user
profiles:</p>
<ul class="simple">
<li>Smart Contract Developer</li>
<li>Frontend Developer</li>
<li>Business Stakeholder</li>
<li>Auditor</li>
</ul>
<p>Not all of these users interact with development tooling directly, or in the
same ways. As such, these use cases should specify appropriately.</p>
<p>This list may not be exhaustive, but should cover the vast majority of required
behaviors.</p>
<div class="section" id="saving-artifacts">
<h2>Saving artifacts<a class="headerlink" href="#saving-artifacts" title="Permalink to this headline">¶</a></h2>
<p>Users and tooling must be able to save new and update existing <a class="reference internal" href="glossary.html#term-artifact"><span class="xref std std-term">Artifact</span></a>
files.</p>
<p>As a core behavior, tooling must facilitate the internal record-keeping of all
known <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a> and <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a>, updating them appropriately
when they change, or when knowledge of them changes.</p>
<p>Beyond that, developers may also need to manually generate new artifacts for
previously unknown contracts.</p>
<p>Since a smart contract blockchain network is effectively a distributed global
database, developers may write their applications for the express or implicit
purpose of accessing other contract instances on that network.</p>
<p>Developers should be able to leverage tooling to interface with these external
contracts, either common, public libraries, or contract instances for other
applications. Tooling should integrate well with code written outside a given
project.</p>
<p>Additionally, some applications may not use tooling’s built-in deployment
systems, and some <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> may deploy others. Tooling should be
able to account for the record-keeping in all these cases.</p>
<p class="plantuml">
<object data="../_images/plantuml-91990d87493f6c7b2dade89df75f00ee324f613f.svg" type="image/svg+xml" style="width:457px;height:350px;">
<img src="../_images/plantuml-91990d87493f6c7b2dade89df75f00ee324f613f.png" alt="left to right direction

:Smart Contract Developer: as :SmartContractDev:

rectangle Saving {
  (Save contract type) as (SaveType)
  (Save contract instance) as (SaveInstance)
  (Save library instance) as (SaveLibrary)
  (Save interface instance) as (SaveInterface)
}

SmartContractDev -- SaveType
SmartContractDev -- SaveInstance
SmartContractDev -- SaveLibrary
SmartContractDev -- SaveInterface" />

</object></p>
<div class="section" id="save-contract-type">
<h3>Save contract type<a class="headerlink" href="#save-contract-type" title="Permalink to this headline">¶</a></h3>
<p>Users must be able to save new <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a>, whether or not it has any
corresponding <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a>.</p>
</div>
<div class="section" id="save-contract-instance">
<h3>Save contract instance<a class="headerlink" href="#save-contract-instance" title="Permalink to this headline">¶</a></h3>
<p>Users must be able to save new <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> on a given network,
identifying them as a known <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a>.</p>
</div>
<div class="section" id="save-library-instance">
<h3>Save library instance<a class="headerlink" href="#save-library-instance" title="Permalink to this headline">¶</a></h3>
<p>Similarly, users must be able to save records of externally-deployed
<a class="reference internal" href="glossary.html#term-library"><span class="xref std std-term">Libraries</span></a>. This is particularly useful, as many commonly-used libraries are
already deployed on a majority of <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Networks</span></a>, and users should not have to pay
the extra gas just to accommodate tooling.</p>
</div>
<div class="section" id="save-interface-instance">
<h3>Save interface instance<a class="headerlink" href="#save-interface-instance" title="Permalink to this headline">¶</a></h3>
<p>In cases where source is not known for an external contract, users may need
reference that <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a> by its interface (i.e. via Solidity’s
<code class="docutils literal notranslate"><span class="pre">interface</span></code> mechanism).</p>
</div>
</div>
<div class="section" id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Permalink to this headline">¶</a></h2>
<p>At the core of smart contract development and deployment is the compilation
of high-level languages to the underlying EVM <a class="reference internal" href="glossary.html#term-bytecode"><span class="xref std std-term">Bytecode</span></a>.</p>
<p>Smart contract developers compile/recompile <a class="reference internal" href="glossary.html#term-source"><span class="xref std std-term">Sources</span></a> many times throughout
the entire lifecycle of development.</p>
<p class="plantuml">
<object data="../_images/plantuml-6e38bb9bcde0f14d1c724a72ff13daae89a62e6a.svg" type="image/svg+xml" style="width:701px;height:348px;">
<img src="../_images/plantuml-6e38bb9bcde0f14d1c724a72ff13daae89a62e6a.png" alt="scale 0.80
left to right direction

:Smart Contract Developer: as :Developer:

rectangle Saving &lt;&lt; external &gt;&gt; {
  (Save contract type) as (SaveType)
}

rectangle Compilation {
  (Compile all project sources) as (CompileAll)

  (Determine modified sources) as (DetermineModified)
  (Compile modified project sources) as (CompileModified)
  CompileModified -&gt; DetermineModified

  (Compile source file) as (Compile)
  Compile -&gt; SaveType

  (Compile primary and related source files) as (CompileMultiple)
  CompileMultiple .|&gt; Compile

  CompileAll --&gt; Compile
  CompileModified --&gt; Compile
}

Developer -- CompileAll
Developer -- CompileModified" />

</object></p>
<div class="section" id="compile-all-project-sources">
<h3>Compile all project sources<a class="headerlink" href="#compile-all-project-sources" title="Permalink to this headline">¶</a></h3>
<p>Either as part of the first development iteration, or to reset, developers must
be able to compile all <a class="reference internal" href="glossary.html#term-source"><span class="xref std std-term">Source</span></a> files in a <a class="reference internal" href="glossary.html#term-project"><span class="xref std std-term">Project</span></a> and obtain saved
<a class="reference internal" href="glossary.html#term-artifact"><span class="xref std std-term">Artifacts</span></a>.</p>
</div>
<div class="section" id="compile-modified-project-sources">
<h3>Compile modified project sources<a class="headerlink" href="#compile-modified-project-sources" title="Permalink to this headline">¶</a></h3>
<p>For most of development, it’s more commonly useful to compile only <a class="reference internal" href="glossary.html#term-source"><span class="xref std std-term">Source</span></a>
files that have changed. Users should be able to perform this minimal
compilation.</p>
</div>
<div class="section" id="determine-modified-sources">
<h3>Determine modified sources<a class="headerlink" href="#determine-modified-sources" title="Permalink to this headline">¶</a></h3>
<p>To support compilation of changed <a class="reference internal" href="glossary.html#term-source"><span class="xref std std-term">Sources</span></a>, tooling should provide a means to
identify which files have changed since their last compilation.</p>
</div>
<div class="section" id="compile-source-file">
<h3>Compile source file<a class="headerlink" href="#compile-source-file" title="Permalink to this headline">¶</a></h3>
<p>Tooling must provide a means to compile a single, standalone <a class="reference internal" href="glossary.html#term-source"><span class="xref std std-term">Source</span></a> file
(no imports), saving a corresponding <a class="reference internal" href="glossary.html#term-artifact"><span class="xref std std-term">Artifact</span></a> for the <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a>.</p>
</div>
<div class="section" id="compile-primary-and-related-source-files">
<h3>Compile primary and related source files<a class="headerlink" href="#compile-primary-and-related-source-files" title="Permalink to this headline">¶</a></h3>
<p>Tooling must provide a means to compile a single <a class="reference internal" href="glossary.html#term-source"><span class="xref std std-term">Source</span></a> file and all sources
it imports, recursively.</p>
</div>
</div>
<div class="section" id="reading-contract-metadata">
<h2>Reading contract metadata<a class="headerlink" href="#reading-contract-metadata" title="Permalink to this headline">¶</a></h2>
<p>Developers, auditors, business stakeholders, et al., all often need to access
metadata information about both <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a> and <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a>.</p>
<p>For example, stakeholders often need to view the JSON ABI, auditors need source
and compiler information, developers need to maintain records of source file
relations and deployment statuses, etc.</p>
<p>Beyond direct access of contract metadata, many other use cases rely on this
metadata heavily.</p>
<p>Metadata should be accessible both for current versions and for all historical
versions that may be in use.</p>
<p class="plantuml">
<object data="../_images/plantuml-afa9b76ccff76231d3ec2a9c28d5fa5d0625396f.svg" type="image/svg+xml" style="width:732px;height:319px;">
<img src="../_images/plantuml-afa9b76ccff76231d3ec2a9c28d5fa5d0625396f.png" alt="scale 0.60
left to right direction

:Smart Contract Developer: as :SmartContractDev:

rectangle Metadata {
  (Read contract instance info) as (ReadContractInstance)
  (Read contract type info) as (ReadContractType)
  (Read historical contract instance type info) as (ReadHistoricalInstanceType)

  (Read instance) as (ReadInstanceData)
  (Read type) as (ReadTypeData)

  ReadInstanceData &lt;|.up. ReadContractInstance
  ReadTypeData &lt;|.up.. ReadContractType
  ReadTypeData &lt;|.up.. ReadHistoricalInstanceType

  ' both
  (Read name) as (ReadName)
  (Read ABI) as (ReadABI)
  (Read bytecodes) as (ReadBytecodes)
  (Read source mappings) as (ReadSourceMaps)
  (Read link values) as (ReadLinkVals)
  (Read sources) as (ReadSources)
  (Read ASTs) as (ReadASTs)

  ' instance
  (Read link references) as (ReadLinkRefs)
  (Read address) as (ReadAddress)

  ReadTypeData --&gt; ReadName
  ReadTypeData --&gt; ReadABI
  ReadTypeData --&gt; ReadBytecodes
  ReadTypeData --&gt; ReadSourceMaps
  ReadTypeData --&gt; ReadLinkRefs
  ReadTypeData --&gt; ReadSources
  ReadTypeData --&gt; ReadASTs

  ReadInstanceData --&gt; ReadTypeData
  ReadInstanceData --&gt; ReadLinkVals
  ReadInstanceData --&gt; ReadAddress
}

SmartContractDev -- ReadContractInstance
SmartContractDev -- ReadContractType
SmartContractDev -- ReadHistoricalInstanceType" />

</object></p>
<div class="section" id="read-contract-instance-information">
<h3>Read contract instance information<a class="headerlink" href="#read-contract-instance-information" title="Permalink to this headline">¶</a></h3>
<p>Users must be able to read <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a> metadata, including ABI, any
link values, and all type-level metadata for that instance.</p>
</div>
<div class="section" id="read-contract-type-info">
<h3>Read contract type info<a class="headerlink" href="#read-contract-type-info" title="Permalink to this headline">¶</a></h3>
<p>Users must be able to read metadata about a <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a> that has not been
deployed, as well as type-level metadata for a given <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a>.</p>
</div>
<div class="section" id="read-contract-instance-historical-type-info">
<h3>Read contract instance historical type info<a class="headerlink" href="#read-contract-instance-historical-type-info" title="Permalink to this headline">¶</a></h3>
<p>If the <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a> has a type that is no longer the current version
in source, users should still be able to read that <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a> information,
for the type at deploy-time. This may differ from the current type version
arbitrarily: different source, different ABI, etc.</p>
</div>
</div>
<div class="section" id="querying-for-specific-contracts">
<h2>Querying for specific contracts<a class="headerlink" href="#querying-for-specific-contracts" title="Permalink to this headline">¶</a></h2>
<p>Developers must be able to view all known <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> on a given
network, or a list of networks with known instances of a given <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a>.</p>
<p class="plantuml">
<object data="../_images/plantuml-0cff306764a4de9c58e4a105baa0aa007dbc819a.svg" type="image/svg+xml" style="width:623px;height:662px;">
<img src="../_images/plantuml-0cff306764a4de9c58e4a105baa0aa007dbc819a.png" alt="left to right direction
:Smart Contract Developer: as :Developer:

rectangle Querying {
  (Query known instances on a given network) as (QueryNetwork)
  (Query all networks for a given type) as (QueryType)
  (Query all networks for instances with a given role) as (QueryInstance)
  (Query for instance by network and address) as (QueryAddress)
  (Query all contracts with a given bytecode) as (QueryBytecode)
  (Query for bytecode ignoring link references) as (QueryBytecodeUnlinked)

  QueryInstance .|&gt; QueryType
  QueryBytecodeUnlinked .|&gt; QueryBytecode
}

Developer -- QueryNetwork
Developer -- QueryType
Developer -- QueryInstance
Developer -- QueryAddress
Developer -- QueryBytecode" />

</object></p>
<div class="section" id="query-for-instance-by-network-and-address">
<h3>Query for instance by network and address<a class="headerlink" href="#query-for-instance-by-network-and-address" title="Permalink to this headline">¶</a></h3>
<p>Users must be able to look up known <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> given a <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Network</span></a>
and an <a class="reference internal" href="glossary.html#term-address"><span class="xref std std-term">Address</span></a>.</p>
</div>
<div class="section" id="query-all-contracts-with-a-given-bytecode">
<h3>Query all contracts with a given bytecode<a class="headerlink" href="#query-all-contracts-with-a-given-bytecode" title="Permalink to this headline">¶</a></h3>
<p>Because it is immutable, contract <a class="reference internal" href="glossary.html#term-bytecode"><span class="xref std std-term">Bytecode</span></a> serves as a reliable secondary
index for both <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> and <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a>. Users should be able to
find all known <a class="reference internal" href="glossary.html#term-contract"><span class="xref std std-term">Contracts</span></a> based on the raw hexadecimal representation of
EVM machine code.</p>
</div>
<div class="section" id="query-for-bytecode-ignoring-link-references">
<h3>Query for bytecode ignoring link references<a class="headerlink" href="#query-for-bytecode-ignoring-link-references" title="Permalink to this headline">¶</a></h3>
<p>Two sets of contract <a class="reference internal" href="glossary.html#term-bytecode"><span class="xref std std-term">Bytecode</span></a> can differ only by <a class="reference internal" href="glossary.html#term-link-value"><span class="xref std std-term">Link Values</span></a>. Users should
be able to query for all <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a> and <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> matching
a given bytecode, whether or not the <a class="reference internal" href="glossary.html#term-link-reference"><span class="xref std std-term">Link References</span></a> have values or match.</p>
</div>
<div class="section" id="query-known-instances-on-a-given-network">
<h3>Query known instances on a given network<a class="headerlink" href="#query-known-instances-on-a-given-network" title="Permalink to this headline">¶</a></h3>
<p>Users should be able to see, at a glance, all <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> on a given
<a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Network</span></a>. This can be useful for validating migration state, or for easy
listing of address / ABI information, to present/share externally.</p>
</div>
<div class="section" id="query-all-networks-for-a-given-type">
<h3>Query all networks for a given type<a class="headerlink" href="#query-all-networks-for-a-given-type" title="Permalink to this headline">¶</a></h3>
<p>Developers often write applications so that each <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a> has a singleton
deployed <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a>. Tooling should enable this first-class nature of
contract types, and users should be able to track the various instances across
all known <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Networks</span></a>.</p>
<p>This is particularly useful when creating front-end applications, referencing
instances across networks with a single type description.</p>
</div>
<div class="section" id="query-all-networks-for-instances-with-a-given-role">
<h3>Query all networks for instances with a given role<a class="headerlink" href="#query-all-networks-for-instances-with-a-given-role" title="Permalink to this headline">¶</a></h3>
<p>In cases where a particular <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a> is not deployed as a singleton,
tooling should provide a mechanism by which users can deploy multiple
<a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a>, identified in some way distinct from type (i.e., <em>role</em>)</p>
<p>As a result, users should be able to use this distinct identifier to query
for analogous instances across <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Networks</span></a>, instead of relying solely on the
type.</p>
</div>
</div>
<div class="section" id="interacting-with-deployed-instances">
<h2>Interacting with deployed instances<a class="headerlink" href="#interacting-with-deployed-instances" title="Permalink to this headline">¶</a></h2>
<p>Besides metadata information, users must be able to retrieve runtime state
information about <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> and to be able to write to those
instances over the network.</p>
<p class="plantuml">
<object data="../_images/plantuml-acf0235557910cdf8d66be30c2da4abb016f0dde.svg" type="image/svg+xml" style="width:561px;height:304px;">
<img src="../_images/plantuml-acf0235557910cdf8d66be30c2da4abb016f0dde.png" alt="left to right direction

:User: as :User:

rectangle Metadata &lt;&lt; external &gt;&gt; {
  (Read ABI) as (ReadABI)
  (Read instance) as (ReadInstance)
  (ReadInstance) -&gt; ReadABI
}

rectangle Interaction {
  (Call read-only method) as (Call)
  (Invoke method via a transaction) as (SendTransaction)
  (Send ETH to a contract instance) as (Send)

  Call --&gt; ReadInstance
  SendTransaction --&gt; ReadInstance
}

User -- Call
User -- SendTransaction
User -- Send" />

</object></p>
<div class="section" id="call-read-only-method">
<h3>Call read-only method<a class="headerlink" href="#call-read-only-method" title="Permalink to this headline">¶</a></h3>
<p>Almost every smart contract provides mechanisms for viewing information
about a <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a>’s current state, including public storage variables
and computed data views. These interfaces are specified for each instance’s
<a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a>, and described in its <a class="reference internal" href="glossary.html#term-abi"><span class="xref std std-term">ABI</span></a>.</p>
<p>Users must be able to call these read-only methods and obtain their results.</p>
</div>
<div class="section" id="invoke-method-via-a-transaction">
<h3>Invoke method via a transaction<a class="headerlink" href="#invoke-method-via-a-transaction" title="Permalink to this headline">¶</a></h3>
<p>Similarly to calls, most contracts provide interface methods for modifying
<a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a> state. Users must be able to execute the allowable
“write” operations for a contract instance.</p>
</div>
<div class="section" id="send-eth-to-a-contract-instance">
<h3>Send ETH to a contract instance<a class="headerlink" href="#send-eth-to-a-contract-instance" title="Permalink to this headline">¶</a></h3>
<p>Many smart contracts expose methods for receiving payment in the form or ether
or other tokens.</p>
<p>Developers must be able to test the receipt of ether; business stakeholders may
have to provide initial funds, for applications that require it.</p>
</div>
</div>
<div class="section" id="linking">
<h2>Linking<a class="headerlink" href="#linking" title="Permalink to this headline">¶</a></h2>
<p>Smart contract development best practices encourage the separation of code
into multiple discrete components. As such, developers may write contracts that
leverage the use of <a class="reference internal" href="glossary.html#term-library"><span class="xref std std-term">Libraries</span></a> to provide composed behavior.</p>
<p><a class="reference internal" href="glossary.html#term-contract"><span class="xref std std-term">Contracts</span></a> using libraries are compiled with unresolved <a class="reference internal" href="glossary.html#term-link-reference"><span class="xref std std-term">Link References</span></a>.
Libraries are deployed as their own instances and later filled in for the
<a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a> as a corresponding <a class="reference internal" href="glossary.html#term-link-value"><span class="xref std std-term">Link Value</span></a>.</p>
<p class="plantuml">
<object data="../_images/plantuml-023d129ffad337344635b28dddc39371dbf45e84.svg" type="image/svg+xml" style="width:749px;height:226px;">
<img src="../_images/plantuml-023d129ffad337344635b28dddc39371dbf45e84.png" alt="left to right direction

:Smart Contract Developer: as :Developer:

rectangle Saving &lt;&lt; external &gt;&gt; {
  (Save contract type) as (SaveType)
  (Save contract instance) as (SaveInstance)
}

rectangle Linking {
  (Link contract type to library) as (LinkType)
  (Link contract instance to library) as (LinkInstance)
  LinkInstance .left.|&gt; LinkType

  LinkType --&gt; SaveType
  LinkInstance --&gt; SaveInstance
}

Developer -- LinkType
Developer -- LinkInstance" />

</object></p>
<div class="section" id="link-contract-type-to-library-instance">
<h3>Link contract type to library instance<a class="headerlink" href="#link-contract-type-to-library-instance" title="Permalink to this headline">¶</a></h3>
<p>Developers must be able to link <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a> to corresponding <a class="reference internal" href="glossary.html#term-library"><span class="xref std std-term">Libraries</span></a>
on a particular <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Network</span></a> or for all networks, so that deployments of that
type are pre-linked.</p>
</div>
<div class="section" id="link-contract-instance-to-library-instance">
<h3>Link contract instance to library instance<a class="headerlink" href="#link-contract-instance-to-library-instance" title="Permalink to this headline">¶</a></h3>
<p>In cases where a <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a> is already deployed, but the
<a class="reference internal" href="glossary.html#term-link-reference"><span class="xref std std-term">Link Reference</span></a> for any <a class="reference internal" href="glossary.html#term-library"><span class="xref std std-term">Library</span></a> is not known, developers should be able to
save the <a class="reference internal" href="glossary.html#term-link-value"><span class="xref std std-term">Link Value</span></a>.</p>
</div>
</div>
<div class="section" id="deployment">
<h2>Deployment<a class="headerlink" href="#deployment" title="Permalink to this headline">¶</a></h2>
<p>During and after the process of creating smart contracts, smart contract
developers need to deploy <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a> on one or more <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Networks</span></a>, creating
one or more <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a>.</p>
<p class="plantuml">
<object data="../_images/plantuml-97e72c0f2ceb7240b442424d815722ba1c811f4e.svg" type="image/svg+xml" style="width:717px;height:227px;">
<img src="../_images/plantuml-97e72c0f2ceb7240b442424d815722ba1c811f4e.png" alt="left to right direction

:Smart Contract Developer: as :Developer:

rectangle Saving &lt;&lt; external &gt;&gt; {
  (Save contract instance) as (SaveInstance)
}

rectangle Deployment {
  (Deploy instance of a type) as (DeployInstance)
  (Deploy multiple instances) as (MultipleInstances)
  MultipleInstances .|&gt; DeployInstance
  DeployInstance --&gt; SaveInstance
}

Developer -- DeployInstance
Developer -- MultipleInstances" />

</object></p>
<div class="section" id="deploy-instance-of-a-type">
<h3>Deploy instance of a type<a class="headerlink" href="#deploy-instance-of-a-type" title="Permalink to this headline">¶</a></h3>
<p>The base case for deployment: given a <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a>, users must be able to
deploy a new <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a> on a particular <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Network</span></a>.</p>
</div>
<div class="section" id="deploy-multiple-instances">
<h3>Deploy multiple instances<a class="headerlink" href="#deploy-multiple-instances" title="Permalink to this headline">¶</a></h3>
<p>For applications that require multiple <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> per <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a>,
users should be able to deploy instances by role or other identifier.</p>
</div>
</div>
<div class="section" id="migrations">
<h2>Migrations<a class="headerlink" href="#migrations" title="Permalink to this headline">¶</a></h2>
<p>Smart contract developers should be able to track the states of
different <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Networks</span></a> separately. <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a> on different
networks can be of different versions of the same <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Type</span></a>. This
difference should be understood by the underlying tooling, and easy to
reason about for the user of the tool.</p>
<p class="plantuml">
<object data="../_images/plantuml-ea0ac14c313b6ade24d499a90231a09f5732bce6.svg" type="image/svg+xml" style="width:648px;height:301px;">
<img src="../_images/plantuml-ea0ac14c313b6ade24d499a90231a09f5732bce6.png" alt="scale 0.55
left to right direction

:Smart Contract Developer: as :Developer:

rectangle Querying &lt;&lt; external &gt;&gt; {
  (Query for a given type) as (QueryType)
}

rectangle Interacting &lt;&lt; external &gt;&gt; {
  (Call read-only method) as (Call)
}

rectangle Linking &lt;&lt; external &gt;&gt; {
  (Link contract type to library) as (LinkType)
}

rectangle Deployment &lt;&lt; external &gt;&gt; {
  (Deploy instance of a type) as (DeployInstance)
}

rectangle Migrations {
  (Run all migrations) as (RunMigrations)
  (Run specific migration) as (RunSpecific)
  (Run as historical) as (RunHistorical)
  (Determine last completed migration) as (DetermineLastCompleted)


  RunHistorical ..|&gt; RunMigrations

  RunMigrations -right-&gt; RunSpecific
  RunMigrations -left-&gt; DetermineLastCompleted

  DetermineLastCompleted -down-&gt; QueryType : find deployed Migrations
  DetermineLastCompleted -down-&gt; Call : read instance state
  RunSpecific -down-&gt; DeployInstance
  RunSpecific -down-&gt; LinkType


}

Developer -- RunMigrations
Developer -- RunSpecific
Developer -- RunHistorical
Developer -- DetermineLastCompleted" />

</object></p>
<div class="section" id="determine-last-completed-migration">
<h3>Determine last completed migration<a class="headerlink" href="#determine-last-completed-migration" title="Permalink to this headline">¶</a></h3>
<p>Querying and reading the on-chain <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instance</span></a> for the <code class="docutils literal notranslate"><span class="pre">Migrations</span></code>
contract, users should be able to determine the most recently completed
migration on that <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Network</span></a>.</p>
</div>
<div class="section" id="run-all-migrations">
<h3>Run all migrations<a class="headerlink" href="#run-all-migrations" title="Permalink to this headline">¶</a></h3>
<p>Either starting at the last completed migration, or resetting from the
beginning, users should be able to run all migrations for a <a class="reference internal" href="glossary.html#term-project"><span class="xref std std-term">Project</span></a> on
a particular <a class="reference internal" href="glossary.html#term-network"><span class="xref std std-term">Network</span></a>.</p>
</div>
<div class="section" id="run-specific-migration">
<h3>Run specific migration<a class="headerlink" href="#run-specific-migration" title="Permalink to this headline">¶</a></h3>
<p>As part of the larger use case of running all migrations, or as a standalone
operation. Users and tooling must support running a single migration.</p>
</div>
<div class="section" id="run-with-historical-types">
<h3>Run with historical types<a class="headerlink" href="#run-with-historical-types" title="Permalink to this headline">¶</a></h3>
<p>Specifying parent network, users should be able to mimic the state of a given
network, determining <a class="reference internal" href="glossary.html#term-contract-type"><span class="xref std std-term">Contract Types</span></a> for all known <a class="reference internal" href="glossary.html#term-contract-instance"><span class="xref std std-term">Contract Instances</span></a>, and
deploy new instances matching those types instead of current.</p>
</div>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>Being able to validate that smart contracts behave as expected is of paramount
importance.</p>
<p>Development workflow best practices involve writing/running automated tests
early and often in the process. Developers should be able to test their
contracts locally before deployment, and once deployed, be able to test their
contract instances locally, matching expected behavior on the network itself.</p>
<p class="plantuml">
<object data="../_images/plantuml-d28b3f3319589464ca765fa49b2dd34e06d174bd.svg" type="image/svg+xml" style="width:685px;height:354px;">
<img src="../_images/plantuml-d28b3f3319589464ca765fa49b2dd34e06d174bd.png" alt="scale 0.80
left to right direction

:Smart Contract Developer: as :Developer:

rectangle tests {
  (Run automated tests for contract type) as (TestType)
  (Run automated tests for contract instance) as (TestInstance)
  (Run automated tests for library type) as (TestLibrary)
  (Run automated tests for library instance) as (TestLibraryInstance)

  (Run test written in Solidity) as (RunSolidity)
  (Run test written in Javascript) as (RunJavascript)

  TestType ..|&gt; RunSolidity
  TestType ..|&gt; RunJavascript

  TestInstance ..|&gt; RunSolidity
  TestInstance ..|&gt; RunJavascript

  TestLibrary ..|&gt; RunSolidity
  TestLibraryInstance ..|&gt; RunSolidity
}

Developer -- TestType
Developer -- TestInstance
Developer -- TestLibrary
Developer -- TestLibraryInstance" />

</object></p>
<div class="section" id="run-automated-tests-for-contract-type">
<h3>Run automated tests for contract type<a class="headerlink" href="#run-automated-tests-for-contract-type" title="Permalink to this headline">¶</a></h3>
<p>Run migrations to deploy fresh instances locally.</p>
</div>
<div class="section" id="run-automated-tests-for-contract-instance">
<h3>Run automated tests for contract instance<a class="headerlink" href="#run-automated-tests-for-contract-instance" title="Permalink to this headline">¶</a></h3>
<p>Contract instance may have a historical contract type (old source, etc.)</p>
<p>Run migrations assuming historical versions and deploy instances locally.</p>
</div>
<div class="section" id="run-automated-tests-for-library-type">
<h3>Run automated tests for library type<a class="headerlink" href="#run-automated-tests-for-library-type" title="Permalink to this headline">¶</a></h3>
<p>Run deploy new instance of library and run tests linked to it.</p>
</div>
<div class="section" id="run-automated-tests-for-library-instance">
<h3>Run automated tests for library instance<a class="headerlink" href="#run-automated-tests-for-library-instance" title="Permalink to this headline">¶</a></h3>
<p>Library instance may represent a historical version of the library type.</p>
<p>Deploy instance of possibly-historical type and run tests linked to it.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="glossary.html" class="btn btn-neutral" title="Glossary" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Truffle Suite.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>